<!DOCTYPE html>
<html lang="ja">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport"
          content="width=device-width, initial-scale=1.0, viewport-fit=cover" />
    <title>社内チャット</title>
  
    <!-- CSS v10 -->
    <link rel="stylesheet" href="styles.css?v=10" />

  </head>  
<body>
  <div class="app">
    <!-- ① ナビゲーション -->
    <aside class="nav">
  <!-- メインナビゲーション：SVGアイコン化 -->
  <button class="nav-icon" aria-label="トーク">
    <span class="icon">
      <!-- 吹き出しSVG：トーク -->
      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24"
        fill="none" stroke="currentColor" stroke-width="2.2"
        stroke-linecap="round" stroke-linejoin="round"
        viewBox="0 0 24 24">
        <path d="M21 12c0 3.9-3.6 7-8 7-1.1 0-2.1-.2-3.1-.5L3 20l1.5-3.4C3.5 15.1 3 13.6 3 12c0-3.9 3.6-7 8-7s8 3.1 8 7z"/>
      </svg>
    </span>
  </button>
  <button class="nav-icon" aria-label="ルーム一覧">
    <span class="icon">
      <!-- リストSVG：ルーム一覧 -->
      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24"
        fill="none" stroke="currentColor" stroke-width="2.2"
        stroke-linecap="round" stroke-linejoin="round"
        viewBox="0 0 24 24">
        <rect x="4" y="4" width="16" height="16" rx="4"/>
        <line x1="8" y1="8" x2="16" y2="8"/>
        <line x1="8" y1="12" x2="16" y2="12"/>
        <line x1="8" y1="16" x2="12" y2="16"/>
      </svg>
    </span>
  </button>
  <button class="nav-icon" aria-label="発送管理">
    <span class="icon">
      <!-- トラックSVG：発送管理 -->
      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24"
        fill="none" stroke="currentColor" stroke-width="2.2"
        stroke-linecap="round" stroke-linejoin="round"
        viewBox="0 0 24 24">
        <rect x="1" y="7" width="15" height="10" rx="2"/>
        <path d="M16 12h3l3 3v2a2 2 0 0 1-2 2h-2"/>
        <circle cx="5.5" cy="18" r="1.5"/>
        <circle cx="18.5" cy="18" r="1.5"/>
      </svg>
    </span>
  </button>
  <!-- 必要ならnav-divider・その他メニューはそのまま -->
  <div class="nav-divider"></div>
</aside>

    

    <!-- ② ルーム一覧 -->
    <section class="conversations">
      <div class="conversations-header">
        <button id="add-room-btn" class="add-room">＋</button>
        <input type="search" id="room-search"
               placeholder="トークルームとメッセージ検索…" autocomplete="off" />
      </div>
      <ul id="conv-list"></ul>
      <button id="logout" class="logout-btn">ログアウト</button>
    </section>

    <!-- ②⇔③ リサイズバー -->
    <div id="conv-resizer" class="resizer"></div>

        <!-- ③ チャットウインドウ -->
        <main class="chat-window">
  <div id="fixed-date-header" class="fixed-date-header"></div>
  
  
        
  <header class="room-bar">
    <!-- 左の空白（or 戻るボタンなどもここに配置可、今は省略） -->
    <div style="width:32px;"></div>
  
    <!-- 中央にグループ名のみ -->
    <div class="room-title">
      <span id="room-name">wing</span>
    </div>
  
    <!-- 右：検索ボタン（SVGで公式風）＋プロフィールアイコン -->
    <div style="display:flex;align-items:center;gap:10px;">
      <button id="toggle-search-btn" class="search-btn" aria-label="メッセージ検索切替">
        <!-- LINE公式そっくり虫眼鏡SVG -->
        <svg width="24" height="24" stroke="currentColor" fill="none" stroke-width="2.2"
          stroke-linecap="round" stroke-linejoin="round" viewBox="0 0 24 24">
          <circle cx="11" cy="11" r="7"/>
          <line x1="16" y1="16" x2="21" y2="21"/>
        </svg>
      </button>
      <div class="profile-container">
        <img src="path/to/avatar.jpg" alt="ユーザーアイコン" class="profile-avatar" />
        <div class="profile-popover">
          <div class="popover-header">
            <img src="path/to/avatar.jpg" alt="ユーザーアイコン" class="avatar-sm" />
            <div class="user-info">
              <div class="user-name" id="header-username">山田 太郎</div>
              <div class="user-email" id="header-email">taro@example.com</div>
            </div>
          </div>
          <ul class="popover-menu">
            <li><a href="settings.html" class="btn-profile-settings">アカウント設定</a></li>
            <li><button class="btn-logout">ログアウト</button></li>
          </ul>                                  
        </div>
      </div>
    </div>
  </header>
          
  <!-- メッセージ検索バー 追加 -->
  <div class="message-search-bar">
    <input type="search"
           id="message-search"
           placeholder="メッセージを検索…"
           autocomplete="off" />
  </div>

  <!-- 返信プレビュー -->
  <div class="reply-preview hidden">
    <span class="original"></span>
    <button class="cancel-btn" aria-label="キャンセル">×</button>
  </div>
        
  <ul id="chat"></ul>

  <!-- 「さらに読み込む」ボタンを追加 -->
  <div id="load-more-container">
    <button id="load-more-btn">さらに読み込む</button>
  </div>

  <div id="input-bar">
    <input type="text" id="message-input"
           placeholder="メッセージを入力…" autocomplete="off" />
    <button id="send-btn">送信</button>
  </div>
</main>
 
  </div>

  <!-- 発送管理サイドドロワー -->
  <aside id="shipping-panel">
  <div class="shipping-header">
    <span>発送管理</span>
    <button id="close-shipping-btn" aria-label="閉じる">&times;</button>
  </div>
  <div class="shipping-tabs">
    <button id="tab-active" class="tab active">進行中</button>
    <button id="tab-completed" class="tab">本日完了</button>
  </div>
  <ul class="shipping-list" id="active-list"></ul>
  <ul class="shipping-list hidden" id="completed-list"></ul>
</aside>


  <!-- ルーム作成モーダル -->
  <div id="room-modal" class="overlay hidden">
    <div class="modal">
      <h2>ルームを作成</h2>
      <input type="text" id="new-room-input" placeholder="新しいルーム名" />
      <div class="modal-buttons">
        <button id="cancel-room-btn" class="btn-cancel">キャンセル</button>
        <button id="create-room-btn" class="btn-create">作成</button>
      </div>
    </div>
  </div>

   <!-- Firebase SDK -->
<script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-auth-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-firestore-compat.js"></script>

<script>
  const firebaseConfig = {
    apiKey: "AIzaSyAC_A8dMvfzc2I8SaKTSfklFDWHgqFZThQ",
    authDomain: "company-chat-app.firebaseapp.com",
    projectId: "company-chat-app",
    storageBucket: "company-chat-app.firebasestorage.app",
    messagingSenderId: "409983657200",
    appId: "1:409983657200:web:bf2f037efb6a292799ce35"
  };

  firebase.initializeApp(firebaseConfig);

  document.addEventListener('DOMContentLoaded', () => {
    firebase.auth().onAuthStateChanged(user => {
      if (user) {
        document.getElementById('header-username').textContent = user.displayName || user.email;
        document.getElementById('header-email').textContent = user.email;
      } else {
        document.getElementById('header-username').textContent = "未ログイン";
        document.getElementById('header-email').textContent = "メール未登録";
      }
    });
  });
</script>



<!-- 編集／削除履歴モーダル -->
<div id="history-modal" class="overlay hidden">
  <div class="modal">
    <h2>編集／削除履歴</h2>
    <ul id="history-list"></ul>
    <button id="close-history-btn">閉じる</button>
  </div>
</div>

<!-- main.js v17 修正版（PC・スマホ版両方対応） -->
<script src="main.js?v=17" defer></script>


<!-- ▼▼▼ ここに追加します ▼▼▼ -->
<div class="bottom-nav">
  <button id="nav-chats" class="active">
    <span class="icon">
      <!-- 吹き出しSVG：トーク -->
      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24"
        fill="none" stroke="currentColor" stroke-width="2.2"
        stroke-linecap="round" stroke-linejoin="round"
        viewBox="0 0 24 24">
        <path d="M21 12c0 3.9-3.6 7-8 7-1.1 0-2.1-.2-3.1-.5L3 20l1.5-3.4C3.5 15.1 3 13.6 3 12c0-3.9 3.6-7 8-7s8 3.1 8 7z"/>
      </svg>
    </span>
    <span>トーク</span>
  </button>
  <button id="nav-rooms">
    <span class="icon">
      <!-- リストSVG：ルーム一覧 -->
      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24"
        fill="none" stroke="currentColor" stroke-width="2.2"
        stroke-linecap="round" stroke-linejoin="round"
        viewBox="0 0 24 24">
        <rect x="4" y="4" width="16" height="16" rx="4"/>
        <line x1="8" y1="8" x2="16" y2="8"/>
        <line x1="8" y1="12" x2="16" y2="12"/>
        <line x1="8" y1="16" x2="12" y2="16"/>
      </svg>
    </span>
    <span>ルーム一覧</span>
  </button>
  <button id="nav-shipping">
    <span class="icon">
      <!-- トラックSVG：発送管理 -->
      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24"
        fill="none" stroke="currentColor" stroke-width="2.2"
        stroke-linecap="round" stroke-linejoin="round"
        viewBox="0 0 24 24">
        <rect x="1" y="7" width="15" height="10" rx="2"/>
        <path d="M16 12h3l3 3v2a2 2 0 0 1-2 2h-2"/>
        <circle cx="5.5" cy="18" r="1.5"/>
        <circle cx="18.5" cy="18" r="1.5"/>
      </svg>
    </span>
    <span>発送管理</span>
  </button>
</div>



        

<!-- 既読メンバーポップアップ -->
<div id="read-members-popup" class="overlay hidden">
  <div class="modal small-modal">
    <h3>既読メンバー一覧</h3>
    <ul id="read-members-list"></ul>
    <button id="close-read-members-btn" class="btn-close">閉じる</button>
  </div>
</div>



</body>
</html>
